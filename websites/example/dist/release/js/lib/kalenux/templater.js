function setTemplate(a,b){var c,d,e,f,g,h,j,c=a.match(/£[\w_,]+£/g);for(f in c){for(e in f=c[f],d=f.replace(/£/g,""),d=d.split(","),d)if(e=d[e],e=eval('b["'+e+'"]'),e)for(g in e=JSON.parse(e),e)h=e[g],eval('b["'+g+'"]="'+h+'"');a=a.replace(f,"")}for(f in c=a.match(/\+[\w\._:,=;*]+\+/g),c){if(f=c[f],d=f.replace(/[\+]/g,""),-1!==d.indexOf("=")?(d=d.split("="),j=d[0],d=d[1]):j=!1,-1!==d.indexOf(".")){if(d=d.split("."),g=d[0].split(","),"*"===g[0])e=JSON.stringify(b);else{for(h in e=[],g)h=g[h],h=b[h],!h&&"0"!==h&&0!==h||e.push('"'+h+'"');e=e.join(",")}e=e||"0"===e||0===e?eval(d[1]+"("+e+")"):""}else e=-1!==d.indexOf(":")?(d=d.split(":"),e=eval(d[1]),e?e[b[d[0]]]:""):-1!==d.indexOf(";")?(d=d.split(";"),e=b[d[0]],e&&d[1]?e[d[1]]:""):b[d]||"0"===e||0===e?b[d]:"";j?b[j]=e:a=a.replace(f,e)}return a=a.replace(/#[£ \w\+=,;:\._]+#/g,""),a}