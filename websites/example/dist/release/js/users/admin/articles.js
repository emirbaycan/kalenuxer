var getter="article";function getUsers(){users={},postJSON(user_api_url+"get/users",function(e){if(1===e.result){for(user in data=e.data)user=data[user],users[user.id]=user.username;kalenuxFillSelect("edit_user",users),kalenuxFillSelect("add_user",users)}},{start:0,limit:999999})}function getCategories(){categories={},postJSON(user_api_url+"get/blog_categories",function(e){if(1===e.result){for(item in data=e.data)item=data[item],categories[item.id]=item.header;kalenuxFillSelect("edit_category",categories),kalenuxFillSelect("add_category",categories)}},{start:0,limit:999999})}function getActions(e){return'<button data-id="'+e+'" class="btn btn-edit" onclick="startAction(this)" data-action="edit_article" data-after="getSet()"><span class="icon-edit"></span></button><button data-id="'+e+'" class="btn btn-del" onclick="del(this)"><span class="icon-delete"></span></button>'}function del(e){postJSON(user_api_url+"del/article",function(e,t){1===e.result&&t.elem.parentNode.parentNode.remove()},{id:e.dataset.id},{elem:e})}function setSpecial(e){return edit_content_json.setContents(JSON.parse(e.content_json)),e}function updateSpecial(e){return e.content_json=JSON.stringify(edit_content_json.getContents()),e.content=edit_content_json.root.innerHTML,e}function addSpecial(e){return e.content_json=JSON.stringify(add_content_json.getContents()),e.content=add_content_json.root.innerHTML,e}function selectLocalImage(){const t=document.createElement("input");t.setAttribute("type","file"),t.click(),t.onchange=()=>{var e=t.files[0];/^image\//.test(e.type)?saveToServer(e):console.warn("You could only upload images.")}}function saveToServer(e){const t=new FormData,n=(t.append("file",e),t.append("order",image_order),t.append("way","news"),new XMLHttpRequest);n.open("POST",user_api_url+"upload/multi",!0),n.onload=()=>{var e;200===n.status&&(e="/"+n.responseText,insertToEditor(e))},n.send(t)}firer.push(function(){getUsers(),getCategories(),$("#add_created_at").datepicker(),$("#edit_created_at").datepicker()}),(add_content_json=new Quill("#add_content",{theme:"snow",formats:["font","header","bold","italic","underline","strike","list","link","image","align"],modules:{toolbar:[[{header:[2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["link","image"]]}})).getModule("toolbar").addHandler("image",()=>{selectLocalImage()}),(edit_content_json=new Quill("#edit_content",{theme:"snow",formats:["header","bold","italic","underline","strike","list","link","image","align"],modules:{toolbar:[[{header:[2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["link","image"]]}})).getModule("toolbar").addHandler("image",()=>{selectLocalImage()});